---
layout: post
title: Mach number demo
subtitle: Look at those shock waves!
tags: [p5js, JavaScript, Graphics]
comments: true
---
<p>
In this post we take a look at a small interactive animation made using [p5*](p5js.org)
graphic library for [JavaScript](https://developer.mozilla.org/es/docs/Web/JavaScript),
that shows pressure waves generated by a point travelling at different speeds relative
to the speed of sound in the medium. You can select the [Mach](https://en.wikipedia.org/wiki/Mach_number)
number using the slider and see the resulting effect.
</p>
<div id="simple-sketch-holder" style="position: relative"></div>
<script src="https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js"></script>

<script>
    let waves = [];
    let next;
    let speed;
    let mSlider;

    function setup() {
        canvas = createCanvas(720, 400);
        canvas.parent('simple-sketch-holder');
        mSlider = createSlider(0, 200, 0);
        mSlider.position(40, 20);
        mSlider.style('width', '80px');
        mSlider.parent('simple-sketch-holder');
        speed = 0.4;
        next = 0;
    }

    function draw() {
        background(200);
        if (millis() > next) {

            // Add new particle
            waves.push(new Wave());
            
            // Schedule next circle
            next = millis() + 500;
        }

        // Draw all paths
        for( let i = 0; i < waves.length; i++) {
            waves[i].update();
            waves[i].display();
            if(waves[i].lifespan <= 0){
            waves.splice(i,1);
            }
        }
        text('Mach', mSlider.x + mSlider.width + 20, 35);
        text(mSlider.value()/100, mSlider.x + mSlider.width + 55, 35);
    }

    class Wave {
        constructor() {
            this.x = width/4;
            this.y = height/2;
            this.diameter = 0;
            this.lifespan = 255;
        }
        
        update() {
            this.diameter += speed*2;
            this.lifespan -= 0.5;
            this.x = this.x + speed * mSlider.value()/100;
        }
        
        display() {
            stroke(0, this.lifespan);
            fill(0,0);
            ellipse(this.x, this.y, this.diameter, this.diameter);
        }
    }
</script>

### The code
In this post I'm not getting into detail about how JavaScript or p5* work, but you
can think of JavaScript as the C++ for web development. In fact, the syntax is very
similar to C/C++, so if you know any of these lenguages you can start programming in
JavaScript relatively easily. You don't need any specific environment to exectue
the JS scripts, they are executed directly in your favourite browser. Without further
delays, here goes the code:

{% highlight js linenos %}
<div id="simple-sketch-holder"></div>
<script src="https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js"></script>

<script>
    let waves = [];
    let next;
    let speed;
    let mSlider;

    function setup() {
        canvas = createCanvas(720, 400);
        canvas.parent('simple-sketch-holder');
        mSlider = createSlider(0, 200, 0);
        mSlider.position(40, 20);
        mSlider.style('width', '80px');
        mSlider.parent('simple-sketch-holder');
        speed = 0.4;
        next = 0;
    }

    function draw() {
        background(200);
        if (millis() > next) {

            // Add new particle
            waves.push(new Wave());
            
            // Schedule next circle
            next = millis() + 500;
        }

        // Draw all paths
        for( let i = 0; i < waves.length; i++) {
            waves[i].update();
            waves[i].display();
            if(waves[i].lifespan <= 0){
            waves.splice(i,1);
            }
        }
        text('Mach', mSlider.x + mSlider.width + 20, 35);
        text(mSlider.value()/100, mSlider.x + mSlider.width + 55, 35);
    }

    class Wave {
        constructor() {
            this.x = width/4;
            this.y = height/2;
            this.diameter = 0;
            this.lifespan = 255;
        }
        
        update() {
            this.diameter += speed*2;
            this.lifespan -= 0.5;
            this.x = this.x + speed * mSlider.value()/100;
        }
        
        display() {
            stroke(0, this.lifespan);
            fill(0,0);
            ellipse(this.x, this.y, this.diameter, this.diameter);
        }
    }
</script>
{% endhighlight %}
